@using Climb.ViewModels
@model CompeteHomeViewModel

@{
	ViewBag.Title = "Home";
	Layout = "_Layout";
}

<div align="center">
	<h2>Home</h2>
	@if(Model.IsHome)
	{
		<h4>Hello @Model.user.Username</h4>
	}
	else
	{
		<h4>Home of @Model.user.Username</h4>
		foreach(var leagueUser in Model.possibleExhibitions)
		{
			<form method="post" asp-controller="Compete" asp-action="Exhibition" asp-route-challengerID="@Model.viewingUser.ID" asp-route-challengedID="@leagueUser.ID">
				<button type="submit" class="btn btn-danger">Fight in @leagueUser.League.Name!</button>
			</form>
		}
	}

</div>
<div class="row">
	<div class="col-xs-3" align="center">
		<h3>Leagues</h3>
		@foreach(var leagueUser in Model.user.LeagueUsers)
		{
			<div class="panel panel-default">
				@Html.Partial("/Views/LeagueUsers/Partials/Info.cshtml", leagueUser)
			</div>
		}
	</div>
	<div class="col-xs-6" align="center">
		@if(Model.overdueSets.Count > 0)
		{
			<h3>OverDue Sets</h3>
			foreach(var set in Model.overdueSets)
			{
				var viewModel = new SetCollapsedViewModel(set.set, set.leagueUser);
				@Html.Partial("/Views/Sets/Partials/Collapsed.cshtml", viewModel)
			}
		}
		
		@if (Model.overdueSets.Count == 0 && Model.availableSets.Count == 0)
		{
			<span>All caught up!</span>
		}
		else if(Model.overdueSets.Count > 0)
		{
			<hr />
		}
		@if(Model.availableSets.Count > 0)
		{
			<h3>Available Sets</h3>
			foreach(var set in Model.availableSets)
			{
				var viewModel = new SetCollapsedViewModel(set.set, set.leagueUser);
				@Html.Partial("/Views/Sets/Partials/Collapsed.cshtml", viewModel)
			}
		}
	</div>
	<div class="col-xs-3" align="center">
		<h3>Activity</h3>
		@{
			var snapshots = Model.GetSortedRankSnapshots();
			foreach(var snapshot in snapshots)
			{
				@Html.Partial("/Views/RankSnapshots/Info.cshtml", snapshot)
			}
		}
	</div>
</div>